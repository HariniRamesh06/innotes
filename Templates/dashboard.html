<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Dashboard</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
</head>
<body>
    <h2>Dashboard</h2>
    
    <h3>Create a New Project</h3>
    <form id="projectForm">
        <input type="text" id="projectName" placeholder="Project Name" required>
        <button type="submit">Create</button>
    </form>
    
    <h3>Projects</h3>
    <ul id="projectList"></ul>
    
    <h3>Add a Task</h3>
    <form id="taskForm">
        <input type="text" id="taskTitle" placeholder="Task Title" required>
        <input type="date" id="taskDeadline" required>
        <button type="submit">Add Task</button>
    </form>
    
    <h3>Tasks</h3>
    <ul id="taskList"></ul>

    <script>
        document.getElementById("projectForm").onsubmit = function(event) {
            event.preventDefault();
            fetch("/projects", {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({ name: document.getElementById("projectName").value })
            }).then(() => location.reload());
        };

        document.getElementById("taskForm").onsubmit = function(event) {
            event.preventDefault();
            fetch("/tasks", {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({ title: document.getElementById("taskTitle").value, deadline: document.getElementById("taskDeadline").value })
            }).then(() => location.reload());
        };

        function loadProjects() {
            fetch("/projects")
                .then(response => response.json())
                .then(projects => {
                    document.getElementById("projectList").innerHTML = projects.map(p => `<li>${p.name}</li>`).join("");
                });
        }

        function loadTasks() {
            fetch("/tasks")
                .then(response => response.json())
                .then(tasks => {
                    document.getElementById("taskList").innerHTML = tasks.map(t => `<li>${t.title} - Due: ${t.deadline}</li>`).join("");
                });
        }

        loadProjects();
        loadTasks();
    </script>
</body>
</html>
